<?php

/*

[*] Wordpress Japanese Anti SEO Web Malware Fixer by @inject0r16
[*] website : ahmeth4n.github.io
[*] mail : ahmethangfx[at]gmail[dot]com
[*] twitter : inject0r16

*/

$sitemap_url = $_SERVER['HTTP_HOST']."/sitemap.xml";
$trojan_path = "temp";
$path = shell_exec("pwd");
$path2 = $path."/temp/1.xml";
$path3 = $path."/wp-admin/images/test.png";
function CheckHttps() {
	if ((!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off') || $_SERVER['SERVER_PORT'] == 443) {
		return true; 
	}
	return false;
}
function ClearConfig(){
    $configName = 'wp-config.php';
    if(file_exist($configName)) {
        $kaynak = file_get_contents('wp-config.php');
        $degis = str_replace("<?php @require('wp-admin/images/test.png');?>","",$kaynak);
        file_put_contents("wp-config.php",$degis);
    } else {
        echo 'LÃ¼tfen Config Yolunuzu Kontrol Ediniz.';
    }
}
function ClearSiteMap(){
    if(CheckHttps()){
        $sitemap = "sitemap: https://".$sitemap_url;
        file_put_contents("sitemap.xml",$sitemap);
    } else {
        $sitemap = "sitemap: http://".$sitemap_url;
        file_put_contents("sitemap.xml",$sitemap);
    }
}
if(is_dir($trojan_path)){
    echo 'Dosya Mevcut!';
    if(file_exists($path2)){
        echo 'Malware tespit edildi!';
        ClearConfig();
        echo 'Config dosyasi temizlendi!';
        $sil = shell_exec("rm -fr temp/");
        $logger_sil = unlink($path3);
        ClearSiteMap();
        echo 'Sitemap temizlendi!';
    }
} else {
    echo 'Sistem guvenli!';
}
?>
